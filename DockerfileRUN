FROM is-wpm:10.15
ARG SAG_TOKEN
WORKDIR /opt/softwareag/wpm
COPY --chown=sagadmin:sagadmin wpm.yml /opt/softwareag/wpm/wpm.yml
USER sagadmin

RUN wpm install -ws https://packages.webmethods.io -wr softwareag -j ${SAG_TOKEN} WmJDBCAdapter

RUN wpm install -r customer_git wmp_sample2

RUN rm /opt/softwareag/wpm/wpm.yml # delete the files since it contains credentials
WORKDIR /
# export SAG_TOKEN=<token> in ~/.bashrc 
# source ~/.bashrc
# check echo $SAG_TOKEN
# docker build --build-arg="SAG_TOKEN=${SAG_TOKEN}" --no-cache -t is-run:10.15 -f DockerfileRUN .
#docker run -p 5556:5555 is-run:10.15
